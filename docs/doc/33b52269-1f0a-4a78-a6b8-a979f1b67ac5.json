{
    "summary": "The TCRegroup class assists in regrouping short-term memory, processing CMV nodes, constructing time sequences, and handling reverse feedback for tir_OPush() action recognition.",
    "details": [
        {
            "comment": "This code defines a `TCRegroup` class with methods for regrouping short-term memory and processing CMV (Command/Motion Vision) nodes. The `rRegroup` method constructs time sequences using input data, updates the model's operating count, and retrieves matching and prototype short-term memories to create ConFos. The `pRegroup` method processes CMV nodes by creating a CmvModel and updating the model's operating count. It also handles support for tir_OPush() reverse feedback.",
            "location": "\"/media/root/Prima/works/he4o/docs/src/SMG_NothingIsAll/AIFoundation/AIThinkingControl/TCRegroup/TCRegroup.m\":0-32",
            "content": "//\n//  TCRegroup.m\n//  SMG_NothingIsAll\n//\n//  Created by jia on 2021/11/28.\n//  Copyright \u00a9 2021\u5e74 XiaoGang. All rights reserved.\n//\n#import \"TCRegroup.h\"\n@implementation TCRegroup\n+(void) rRegroup:(AIShortMatchModel*)shortModel{\n    //1. \u6784\u5efa\u65f6\u5e8f (\u628a\u6bcf\u6b21dic\u8f93\u5165,\u90fd\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u7684\u5185\u5b58\u65f6\u5e8f);\n    [theTC updateOperCount:kFILENAME];\n    Debug();\n    NSArray *matchAShortMem = [theTC.inModelManager shortCache:true];\n    shortModel.matchAFo = [theNet createConFo:matchAShortMem];\n    NSArray *protoAShortMem = [theTC.inModelManager shortCache:false];\n    shortModel.protoFo = [theNet createConFo:protoAShortMem];\n    DebugE();\n}\n/**\n *  MARK:--------------------\u5165\u53e3--------------------\n *  @version\n *      20200120 - \u6784\u5efaprotoFo\u540e,\u77ac\u65f6\u8bb0\u5fc6\u6539\u4e3a\u4e0d\u6e05\u7a7a,\u4e3a\u89e3\u51b3\u5916\u5c42\u6b7b\u5faa\u73af\u95ee\u9898 (\u56e0\u4e3a\u5916\u5c42\u5faa\u73af\u9700\u8981\u884c\u4e3a\u8f93\u51fa\u540e,\u5c06\u65f6\u5e8f\u8fde\u8d77\u6765) \u53c2\u8003n18p5-BUG9\n *      20200416 - \u5c06\u5148\"mv\u9700\u6c42\u5904\u7406\"\u540e\"\u5b66\u4e60\",\u6539\u4e3a\u5148\"\u5b66\u4e60\"\u540e\"mv\u9700\u6c42\u5904\u7406\",\u56e0\u4e3a\u5916\u5c42\u6b7b\u5faa\u73af (\u53c2\u8003n19p5-B\u7ec4BUG2);\n *      20210120 - \u652f\u6301tir_OPush()\u53cd\u5411\u53cd\u9988\u7c7b\u6bd4;\n */\n+(void) pRegroup:(AICMVNodeBase*)mv shortModel:(AIShortMatchModel*)shortModel{\n    //1. \u8054\u60f3\u5230mv\u65f6,\u521b\u5efaCmvModel\u53d6\u5230FoNode;\n    [theTC updateOperCount:kFILENAME];"
        },
        {
            "comment": "Creates a CMV model, finds FoNode, and clears short-term memory.",
            "location": "\"/media/root/Prima/works/he4o/docs/src/SMG_NothingIsAll/AIFoundation/AIThinkingControl/TCRegroup/TCRegroup.m\":33-62",
            "content": "    Debug();\n    //2. \u521b\u5efaCmvModel\u53d6\u5230FoNode;\n    shortModel.protoFo = [theNet createCMVFo:shortModel.inputTime order:[theTC.inModelManager shortCache:false] mv:mv];\n    //[self.shortMemory clear] (\u53c2\u8003\u6ce8\u91ca2020.01.20);\n    DebugE();\n}\n/**\n *  MARK:--------------------feedbackTOR\u540e\u91cd\u7ec4--------------------\n *  @desc\n *      \u8bf4\u660e: \u5728foModel\u4e0b\u627e\u5230subAlgModel,\u5176\u4e2dfeedbackAlg\u6709\u503c\u7684,\u66ff\u6362\u5230foModel\u4e2d,\u5e76\u91cd\u7ec4\u6210\u65b0\u7684\u65f6\u5e8f;\n *      \u4f8b\u5982: [\u6211\u8981\u5403\u6c34\u679c],\u7ed3\u679c\u53cd\u9988\u4e86\u69b4\u83b2,\u91cd\u7ec4\u6210[\u6211\u8981\u5403\u69b4\u83b2];\n *  @param feedbackFrameOfMatchAlgs : \u89e6\u53d1\u8c03\u7528\u6b64\u53cd\u9988\u91cd\u7ec4\u65b9\u6cd5\u7684protoAlg\u7684\u8bc6\u522bmatchAlgs\u7ed3\u679c (\u53c2\u800328103-2.2);\n *  @version\n *      2023.07.08: \u5199\u4e86action\u884c\u4e3a\u5316\u53cd\u601d\u540e,\u8fd9\u91cc\u5df2\u7ecf\u6ca1\u7528\u4e86,\u6240\u4ee5\u5173\u6389 (\u53c2\u800330054-\u53e6\u5916);\n */\n+(void) feedbackRegroup:(TOFoModel*)foModel feedbackFrameOfMatchAlgs:(NSArray*)feedbackFrameOfMatchAlgs {\n    //1. \u6570\u636e\u51c6\u5907;\n    if (!Switch4FeedbackRegroup) return;\n    [theTC updateOperCount:kFILENAME];\n    Debug();\n    //3. \u6570\u636e\u51c6\u5907 (\u6536\u96c6\u9664\u672b\u4f4d\u5916\u7684content\u4e3aorder);\n    NSArray *order = [foModel getOrderUseMatchAndFeedbackAlg:true];\n    //6. \u5c06\u65f6\u5e8f\u5143\u7d20\u751f\u6210\u65b0\u65f6\u5e8f;\n    AIFoNodeBase *regroupFo = [theNet createConFo:order];\n    //7. \u8bc6\u522b\u65f6\u5e8f (\u9884\u6d4b\u5230\u9e21\u86cb\u53d8\u810f,\u6216\u8005cpu\u635f\u574f) (\u7406\u6027\u9884\u6d4b\u5f71\u54cd\u8bc4\u4ef7\u5373\u7406\u6027\u8bc4\u4ef7);"
        },
        {
            "comment": "This code is performing action regrouping in a TCRecognition system. It collects the recent fo models, adds them to an order array, and then appends the forthcoming fo model's protoFo as the latter part of the sequence. This method is called with an action foModel.",
            "location": "\"/media/root/Prima/works/he4o/docs/src/SMG_NothingIsAll/AIFoundation/AIThinkingControl/TCRegroup/TCRegroup.m\":63-87",
            "content": "    DebugE();\n    [TCRecognition feedbackRecognition:regroupFo foModel:foModel feedbackFrameOfMatchAlgs:feedbackFrameOfMatchAlgs];\n}\n/**\n *  MARK:--------------------action\u8f93\u51fa\u524d\u91cd\u7ec4--------------------\n *  @desc \u5c06\u77ac\u65f6\u8bb0\u5fc6\u51e0\u5e27 + canset\u8981cutIndex\u4e4b\u540e\u8981\u8f93\u51fa\u7684\u51e0\u5e27 = \u62fc\u63a5\u8d77\u6765 (\u53c2\u800330054-\u65b9\u6848&\u53e6\u59161);\n *  @version\n *      2023.07.09: \u4fee\u590d\u4e0a\u5e27\u4e3a\u8f93\u51fa\u6216mv\u65f6,\u672a\u751f\u6210protoFo,\u5bfc\u81f4\u6536\u96c6\u4e0d\u5230\u524d\u534a\u90e8\u5206order\u7684\u95ee\u9898 (\u53c2\u800330056);\n *      2023.07.09: \u4fee\u590dorder\u7684\u65f6\u95f4\u9519\u4e71\u7684\u95ee\u9898 (\u5c06\u524d\u540e\u90e8\u5206\u7edf\u4e00\u4e3a\u65f6\u95f4\u6233,\u4ee5\u4f7fregroupFo\u751f\u6210deltaTimes\u6b63\u786e);\n *      2023.11.16: \u4fee\u590dorder\u7684inputTime\u65f6\u95f4\u524d\u5927\u540e\u5c0f\u7684BUG (\u6bcf\u6b21\u5faa\u73af\u540e\u66f4\u65b0lastInputTime\u5373\u53ef);\n *      2023.11.16: \u7b80\u5316\u4ee3\u7801: \u76f4\u63a5\u6539\u6210isTimestamp=false\u65b9\u5f0f\u6765\u6536\u96c6\u540e\u534a\u90e8\u5206;\n */\n+(void) actionRegroup:(TOFoModel*)actionFoModel {\n    //1. \u6570\u636e\u51c6\u5907;\n    [theTC updateOperCount:kFILENAME];\n    Debug();\n    NSMutableArray *order = [[NSMutableArray alloc] init];\n    //2. \u6536\u96c6\u77ac\u65f6\u8bb0\u5fc6\"\u521a\u5df2\u53d1\u751f\u7684protoFo\"\u505a\u4e3a\u524d\u534a\u90e8\u5206 (\u53c2\u800330054-todo1);\n    [order addObjectsFromArray:[theTC.inModelManager shortCache:false]];\n    NSInteger regroupCutIndex = order.count - 1;\n    //3. \u6536\u96c6cansetFo\"\u5373\u5c06\u884c\u4e3a\u5316\u7684\u90e8\u5206\"\u505a\u4e3a\u540e\u534a\u90e8\u5206 (\u53c2\u800330054-todo2);\n    AIFoNodeBase *actionFo = [SMGUtils searchNode:actionFoModel.content_p];"
        },
        {
            "comment": "This code is iterating through action indices and creating short match models with input time from delta times. These models are then added to an order. The order is used to create a new sequential element. This new element is recognized by the TCRecognition method, which takes the newly created sequential element, the original action model, and a regroup cut index as parameters. This process seems to be related to recognizing actions in a sequence and possibly making predictions or evaluations based on those actions.",
            "location": "\"/media/root/Prima/works/he4o/docs/src/SMG_NothingIsAll/AIFoundation/AIThinkingControl/TCRegroup/TCRegroup.m\":88-102",
            "content": "    for (NSInteger i = actionFoModel.actionIndex; i <= MIN(actionFoModel.targetSPIndex, actionFo.count - 1); i++) {\n        AIKVPointer *item_p = ARR_INDEX(actionFo.content_ps, i);\n        NSTimeInterval deltaTime = [NUMTOOK(ARR_INDEX(actionFo.deltaTimes, i)) doubleValue];\n        [order addObject:[AIShortMatchModel_Simple newWithAlg_p:item_p inputTime:deltaTime isTimestamp:false]];\n    }\n    //4. \u5c06\u65f6\u5e8f\u5143\u7d20\u751f\u6210\u65b0\u65f6\u5e8f (\u53c2\u800330054-todo3);\n    AIFoNodeBase *regroupFo = [theNet createConFo:order];\n    //5. \u8bc6\u522b\u65f6\u5e8f (\u9884\u6d4b\u5230\u9e21\u86cb\u53d8\u810f,\u6216\u8005cpu\u635f\u574f) (\u7406\u6027\u9884\u6d4b\u5f71\u54cd\u8bc4\u4ef7\u5373\u7406\u6027\u8bc4\u4ef7) (\u53c2\u800330054-todo3);\n    DebugE();\n    [TCRecognition actionRecognition:regroupFo baseActionFo:actionFoModel regroupCutIndex:regroupCutIndex];\n}\n@end"
        }
    ]
}